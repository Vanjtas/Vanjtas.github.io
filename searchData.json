[{"title":"搭建个人网站(2)","url":"/2021/05/09/搭建个人网站2/","content":"\n## 更新日志\n20210510 更新到swap的安装，这次涉及了一些服务器调优的内容，不过就是冰山一角，果然运维也没那么好干。docker就等有空再看吧，近期应该是不看了。后面的计划是把网站基础网页做一做，然后把支付绑定弄一弄。还有今天在做的时候发现插件做全响应果然不是很智能，没法分开做，也要看看后面如何改善。\n\n## 目标\n  想了下还是和上篇分开写吧。上次做到简单配置了服务器，这次就是弄下wordpress。原本是想docker + wordpress，结果docker果然还是正不太明白，弄了一天还是不懂，果断直接wordpress算了。项目跑起来为第一。\n  所以这次主要就是写下装wordpress和之后遇到的问题。\n\n## wordpress安装和服务器调优\n  wordpress安装其实没什么可说的，直接下载解压用winSCP移到服务器根目录。之后打开域名照着装就行了。对了就装之前去新建个数据库。\n  装完配置一下语言和时区，还有比较重要的固定连接，懒得研究了直接偷懒选了文章名。\n  后面就装各种插件了，主要Elements和Elementor（真正全自动化...），其他靠主题内置的自动装好就行了了，WooCommerce什么的。\n  全部装完就大功告成了，理论上可以开始做网页了，但是在做的过程中三番五次打不开服务器，各种崩溃找不到数据库加500错误。最后google了一天，途中top命令各种看也看不太明白...最后才明白是内存爆了。毕竟最低配的服务器情理之中吧。于是开始找解决办法，最后决定swap file走起。\n  简单总结一下，linux swap就是内存快满了之后与磁盘交换文件以维持运行，速度虽然会下降但是不会和上面一样说的崩溃。其中分swap partition和swap file，区别就是swap file更灵活，毕竟不用分区。\n\n### 创建swap file\n\n```linux\n   #创建swapfile\n   sudo fallocate -l 1G /swapfile\n\n   #权限\n   sudo chmod 600 /swapfile\n\n   #格式化\n   sudo mkswap /swapfile\n\n   #启用交换\n   sudo swapon /swapfile\n\n   #设置永久性\n   vim /etc/fstab\n```\n### 文件中添加\n```linux\n   /swapfile swap swap defaults 0 0\n```\n\n### 最后可以检查下状态\n```linux\n   sudo free -h\n```\n### 设置swappiness\n   swappiness就是定义swap空间使用频率的\n```linux\n   #查看当前swappiness值\n   cat /proc/sys/vm/swappiness\n\n   #更改swappiness值\n   vim /etc/sysctl.conf\n```\n   里面加上一句\n```linux\n   vm.swappiness=10\n```\n   大功告成\n\n   以上关于swap的内容全部参照下面链接，老哥讲的清晰明了。\n   <https://www.youtube.com/watch?v=0mgefj9ibRE>\n\n"},{"title":"搭建个人网站(1)","url":"/2021/05/03/搭建个人网站1/","content":"\n\n## 更新日志\n20210504 新建了此博客，建站过程到第五步。网站方面只做到访问域名后能连通。后面就是真正的写内容了。现在计划的是用WordPress+WooCommerce直接快速建站，后面定制的地方再自己去改。\n\n## 目标\n  搭建这个网站的目的是做一个电商网站，有基本的页面浏览和支付系统就可以。也是继用hexo搭建个人博客之后的一个进阶吧。可以边熟悉linux边了解一些运维知识（加上补补网络协议）。后续补强Java和JavaScript的时候也有一个练习的地方。\n  附上网站，进度参照更新日志： <https://www.vanjtas.com>\n\n## 阿里云+VestaCP 搭建个人网站\n下面就记录下搭建个人网站的过程。也以防服务器玩儿坏了需要初始化，当作配置文档了。\n\n#### 第一步\n租服务器服务和域名。因为不在国内没有手机号所以用的阿里云国际版，ECS送了12个月（美滋滋），虽然是最低配但是练手完全够用了，环境必然选了centos7。域名也相应租了一年的。\n\n#### 第二步\n更改实例密码，配置安全组，打开需要用的端口，80，22等等。关联实例启用安全组。\n\n#### 第三步\n用公有IP和密码连接ssh远程登录（用的SecureCRT），顺便设置了一下WinSCP之后会用。\n\n#### 第四步\n犹豫了很久要手动配置还是用管理面板。纠结巨久之后因为运维知识不够怕后面搞不定所以还是用了管理面板。宝塔不给国外手机号注册所以用了VestaCP。不得不说为了找宝塔的替代品找了一下午，不知道为什么大部分相关推荐的帖子都是两年前的。\n这里放一下安装的两个命令，进ssh里装就行了：\n\n```linux\n    curl -O http://vestacp.com/pub/vst-install.sh\n\n    bash vst-install.sh\n```\n\n键入上面命令之后输入可用邮箱和hostname，hostname就在左边写着呢。\n等大概10分钟就好了，会有网址和用户名密码。\n\n#### 第五步\n用用户名密码进入网址，去web服务新建域名，把租的域名绑定上。勾选上ssl，用Let's Encrypt就行。最后去nginx里把http请求强制转换成https协议就行了。\n顺便写下VestaCP装的nginx的路径: `/etc/nginix`\n修改文件 `/etc/nginix/conf.d/私网IP.conf`\n\n```linux\n    server {   \n    listen       私网IP:80 default;   \n    server_name  域名;   \n    #access_log  /var/log/nginx/私网IP.log main;   \n    \n    rewrite ^(.*)$  https://$host$1 permanent;   \n   \n    location / {   \n        proxy_pass  http://私网IP:8080;   \n      }   \n   }\n```\n\n\n\n"},{"title":"欢迎来到Jiao的博客","url":"/2021/04/25/欢迎来到Jiao的博客/","content":"\n\n## 2021年4月25日博客搭建成功\n\n  欢迎来到我的博客\n"}]